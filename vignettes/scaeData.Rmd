---
title: "scaeData User Guide"
date: "`r format(Sys.time(), '%d %b %Y')`"
output:
  BiocStyle::html_document:
    toc_float: true
    fig_width: 8
    fig_height: 6
vignette: >
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteIndexEntry{scaeData User Guide}
  %\VignetteEncoding[utf8]{inputenc}
---

# scaeData

`scaeData` is a complementary package to the Bioconductor package `SingleCellAlleleExperiment`. It contains three datasets to be used when testing functions in `SingleCellAlleleExperiment`. These are: 

- 5k PBMCs of a healthy donor, 3' v3 chemistry
- 10k PBMCs of a healthy donor, 3' v3 chemistry
- 20k PBMCs of a healthy donor, 3' v3 chemistry

The raw FASTQs for all three datasets were sourced from publicly accessible datasets provided by [10x Genomics](https://www.10xgenomics.com/datasets).

Upon downloading, [scIGD](https://github.com/AGImkeller/scIGD) Snakemake workflow was utilized to perform HLA allele-typing processes and generate allele-specific quantification from scRNA-seq data using donor-specific references.

# Quick Start

## Installation

From Bioconductor:

```{r, eval=FALSE}
if (!requireNamespace("BiocManager", quietly=TRUE))
    install.packages("BiocManager")

BiocManager::install("scaeData")
```

Alternatively, a development version is available on GitHub and can be installed via:

```{r, eval=FALSE}
if (!require("devtools", quietly = TRUE))
    install.packages("devtools")

devtools::install_github("AGImkeller/scaeData", build_vignettes = TRUE)
```

# Usage

The datasets within `scaeData` are accessible using the `scaeDataGet` function:

```{r libraries, include=TRUE}
suppressPackageStartupMessages({
  library(scaeData)
  # library(SingleCellAlleleExperiment)
})
```

```{r}
pbmc_5k <- scaeDataGet("pbmc_5k")
pbmc_10k <- scaeDataGet("pbmc_10k")
pbmc_20k <- scaeDataGet("pbmc_20k")

pbmc_20k
```

For example, we can view pbmc 20k:

```{r}
cells.dir <- file.path(pbmc_20k$dir, pbmc_20k$barcodes)
features.dir <- file.path(pbmc_20k$dir, pbmc_20k$features)
mat.dir <- file.path(pbmc_20k$dir, pbmc_20k$matrix)

cells <- utils::read.csv(cells.dir, sep = "", header = FALSE)
features <- utils::read.delim(features.dir, header = FALSE)
mat <- Matrix::readMM(mat.dir)

rownames(mat) <- cells$V1
colnames(mat) <- features$V1
head(mat)
```

A `SingleCellAlleleExperiment` object, `scae` for short, can be generated using the `read_allele_counts()` function retrieved from the `SingleCellAlleleExperiment` package.

A lookup table corresponding to each dataset, facilitating the creation of relevant additional data layers during object generation, can be downloaded from the [GitHub repo] (https://github.com/AGImkeller/scaeData/tree/devel/inst/extdata):

```{r, eval = FALSE}
scae_20k <- read_allele_counts(pbmc_20k$dir,
                               sample_names = "example_data",
                               filter = "yes",
                               exp_type = "WTA",
                               lookup_file = "pbmc_20k_lookup_table.csv",
                               barcode_file = pbmc_20k$barcodes,
                               gene_file = pbmc_20k$features,
                               matrix_file = pbmc_20k$matrix,
                               verbose = TRUE)

scae_20k
```

# Session info {-}

```{r sessionInfo}
sessionInfo()
```
